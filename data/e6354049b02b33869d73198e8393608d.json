{"id": "e6354049b02b33869d73198e8393608d", "url_s": "https://opensourceconnections.com/blog/2013/11/15/using-cassandra-to-build-a-naive-bayes-classifier-of-users-based-upon-behavior/", "title": "Using Cassandra to Build a Naive Bayes Classifier of Users Based Upon Behavior", "content": ["In our last post, we found out how simple it is to use Cassandra to estimate ad conversion. Its easy, because effectively all you have to do is accumulate counts \u2013 and Cassandra is quite good at counting. As we demonstrated in that post, Cassandra can be used as a giant, distributed, redundant, \"infinitely\" scalable counting framework. During this post will take the online ad company example just a bit further by creating a Cassandra-backed Naive Bayes Classifier. Again, we see that the \"secret sauce\" is simply keeping track of the appropriate counts.", "In the previous post, we helped equip your online ad company with the ability to track ad conversion rates. But competition is steep and well need to do a little better than ad conversion rates if your company is to stay on top. Recently, suspicions have arisen that ads are often being shown to unlikely customers. A quick look at the logs confirms this concern. For instance, there was a case of one internet user that clicked almost every single ad that he was shown \u2013 so long as it related to the camping gear. Several times, he went on to make purchases: a tent, a lantern, and a sleeping bag. But despite this users obvious interest in outdoor sporting goods, your logs indicated that fully 90% of the ads he was shown were for womens apparel. Of these ads, this user clicked none of them.", "Lets attack this problem by creating a classifier. Fortunately for us, your company specializes in two main genres, fashion, and outdoors sporting goods. If we can determine which type of user were dealing with, then we can improve our conversion rates considerably by simply showing users the appropriate ads.", "Naive Bayes Classifiers", "With this goal in mind, lets look at the theory behind Naive Bayes Classifiers so that we can build our own. The purpose of a classifier is to identify which group a sample belongs to based upon the given evidence. In this case, our \"sample\", is an individual user, and based upon the evidence of which ads she clicks, we wish to identify which group she belongs to: fashion or outdoors. To put some math to the problem, consider the following question:", "What is the probability that user is from group    given the fact that this user has clicked on ads   ,   , and   ?", "To put this into equation form, we can write:"], "summary_t": "", "title_payloads": ["use|2.0 Cassandra|4.0 to build|2.0 a naive|1.5 Bayes|2.0 Classifier|4.0 of user|3.5 base|2.0 Upon Behavior|3.5 "], "content_payloads": ["In our last|1.5 post|3.5 , we find|2.0 out how|1.5 simple|1.5 it is to use|2.0 Cassandra|4.0 to estimate|2.0 ad|2.0 conversion|4.0 . ", "Its easy|1.5 , because effectively|1.5 all you have to do is accumulate|2.0 count|4.0 \u2013 and Cassandra|4.0 is quite|1.5 good|1.5 at counting|3.5 . ", "As we demonstrate|2.0 in that post|3.5 , Cassandra|4.0 can|2.0 be use|2.0 as a giant|3.5 , distribute|2.0 , redundant|1.5 , \"infinitely|1.5 \" scalable|1.5 counting|2.0 framework|2.0 . ", "During this post|3.5 will|2.0 take|2.0 the online|1.5 ad|2.0 company|4.0 example|4.0 just|1.5 a bit|2.0 far|1.5 by create|2.0 a Cassandra|2.0 -back|2.0 Naive|2.0 Bayes|2.0 Classifier|4.0 . ", "again|1.5 , we see|2.0 that the \"secret|1.5 sauce|4.0 \" is simply|1.5 keep|2.0 track|4.0 of the appropriate|1.5 count|3.5 . ", "In the previous|1.5 post|3.5 , we help|2.0 equip|2.0 your online|1.5 ad|2.0 company|4.0 with the ability|3.5 to track|2.0 ad|2.0 conversion|2.0 rate|4.0 . ", "But competition|4.0 is steep|1.5 and well|1.5 need|2.0 to do a little|1.5 well|1.5 than ad|2.0 conversion|2.0 rate|3.5 if your company|4.0 is to stay|2.0 on top|3.5 . ", "recently|1.5 , suspicion|4.0 have arise|2.0 that ad|4.0 are often|1.5 being show|2.0 to unlikely|1.5 customer|3.5 . ", "A quick|1.5 look|4.0 at the logs|3.5 confirm|2.0 this concern|4.0 . ", "For instance|3.5 , there was a case|2.0 of one internet|2.0 user|3.5 that click|2.0 almost|1.5 every single|1.5 ad|4.0 that he was show|2.0 \u2013 so|1.5 long|1.5 as it relate|2.0 to the camping|2.0 gear|3.5 . ", "several|1.5 time|2.0 , he go|2.0 on to make|2.0 purchase|4.0 : a tent|2.0 , a lantern|2.0 , and a sleep|2.0 bag|2.0 . ", "But despite this user|2.0 obvious|1.5 interest|3.5 in outdoor|1.5 sporting|2.0 good|3.5 , your log|4.0 indicate|2.0 that fully|1.5 90% of the ad|3.5 he was show|2.0 were for womens|1.5 apparel|3.5 . ", "Of these ad|3.5 , this user|4.0 click|2.0 none|4.0 of them. ", "let|2.0 attack|4.0 this problem|4.0 by create|2.0 a classifier|4.0 . ", "fortunately|1.5 for us, your company|4.0 specialize|2.0 in two main|1.5 genre|3.5 , fashion|2.0 , and outdoors|1.5 sporting|2.0 good|2.0 . ", "If we can|2.0 determine|2.0 which type|4.0 of user|3.5 were deal|2.0 with, then|1.5 we can|2.0 improve|2.0 our conversion|2.0 rate|4.0 considerably|1.5 by simply|1.5 show|2.0 user|2.0 the appropriate|1.5 ad|4.0 . ", "naive|1.5 Bayes|2.0 Classifiers|4.0 With this goal|3.5 in mind|3.5 , let|2.0 look|2.0 at the theory|3.5 behind Naive|2.0 Bayes|2.0 Classifiers|3.5 so that we can|2.0 build|2.0 our own|3.5 . ", "The purpose|4.0 of a classifier|3.5 is to identify|2.0 which group|3.5 a sample|4.0 belong|2.0 to base|2.0 upon the give|2.0 evidence|3.5 . ", "In this case|3.5 , our \"sample|4.0 \", is an individual|1.5 user|2.0 , and base|2.0 upon the evidence|3.5 of which ad|2.0 she click|2.0 , we wish|2.0 to identify|2.0 which group|3.5 she belong|2.0 to: fashion|3.5 or outdoors|1.5 . ", "To put|2.0 some math|4.0 to the problem|3.5 , consider|2.0 the following|1.5 question|4.0 : What is the probability|4.0 that user|4.0 is from group|3.5 give|2.0 the fact|3.5 that this user|4.0 has click|2.0 on ad|3.5 , , and ? ", "To put|2.0 this into equation|2.0 form|3.5 , we can|2.0 write|2.0 :"]}